---
title: diff
description: Compare the database schema from two arbitrary sources
metaTitle: prisma migrate diff | Compare Database Schemas
metaDescription: 'Compare two schema sources with prisma migrate diff. Output human-readable summary or SQL script. Supports db, schema, migrations.'
url: /cli/migrate/diff
---

The `prisma migrate diff` command compares two database schema sources and outputs a description of the migration needed to transform the first into the second.

:::info

This command is only partially supported for [MongoDB](/orm/core-concepts/supported-databases/mongodb). See options below for details.

:::

## Usage

```bash
prisma migrate diff --from-... <source1> --to-... <source2>
```

The output can be a human-readable summary (default) or an executable script.

:::warning

The `migrate diff` command can only compare database features [supported by Prisma](/orm/reference/database-features). Differences in unsupported features (views, triggers, etc.) won't be shown.

:::

## Prerequisites

If using `--from-config-datasource` or `--to-config-datasource`, configure your database connection in `prisma.config.ts`:

```prisma file=schema.prisma
generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}
```

```typescript file=prisma.config.ts
import { defineConfig, env } from "prisma/config";

export default defineConfig({
  schema: "prisma/schema.prisma",
  migrations: {
    path: "prisma/migrations",
  },
  datasource: {
    url: env("DATABASE_URL"),
  },
});
```

## Source types

Both sources must use the same database provider.

### From options (one required)

| Option                     | Description                              | Notes                    |
| -------------------------- | ---------------------------------------- | ------------------------ |
| `--from-empty`             | Assume the source is an empty data model |                          |
| `--from-schema`            | Path to a Prisma schema file             |                          |
| `--from-migrations`        | Path to Prisma migrations directory      | Not supported in MongoDB |
| `--from-config-datasource` | Use datasource from Prisma config file   | Prisma v7+                |

### To options (one required)

| Option                   | Description                                   | Notes                    |
| ------------------------ | --------------------------------------------- | ------------------------ |
| `--to-empty`             | Assume the destination is an empty data model |                          |
| `--to-schema`            | Path to a Prisma schema file                  |                          |
| `--to-migrations`        | Path to Prisma migrations directory           | Not supported in MongoDB |
| `--to-config-datasource` | Use datasource from Prisma config file        | Prisma v7+                |

### Other options

| Option           | Description                                              | Notes                       |
| ---------------- | -------------------------------------------------------- | --------------------------- |
| `--config`       | Custom path to your Prisma config file                   |                             |
| `--script`       | Output a SQL script instead of human-readable summary    | Not supported in MongoDB    |
| `-o`, `--output` | Write to a file instead of stdout                        | Available since 5.12.1      |
| `--exit-code`    | Change exit code behavior: Empty=0, Error=1, Not empty=2 | Default: Success=0, Error=1 |
| `--help`         | Display help message                                     |                             |

:::info

**Prisma v7 breaking change**: The `--from-url`, `--to-url`, `--from-schema-datasource`, `--to-schema-datasource`, and `--shadow-database-url` options have been removed. Use `--from-config-datasource` and `--to-config-datasource` instead.

:::

## Examples

### Compare database to schema

Roll forward after a migration failed:

```npm
npx prisma migrate diff \
  --from-config-datasource \
  --to-schema=next_datamodel.prisma \
  --script
```

### Compare schema to database

```npm
npx prisma migrate diff \
  --from-schema=schema.prisma \
  --to-config-datasource \
  --script
```

### Compare migrations to database

Generate a migration for a hotfix already applied on production:

```npm
npx prisma migrate diff \
  --from-migrations ./migrations \
  --to-config-datasource \
  --script
```

### Pipe output to db execute

```npm
npx prisma migrate diff \
  --from-config-datasource \
  --to-schema=schema.prisma \
  --script | prisma db execute --stdin
```

### Check if sources are in sync

Exits with code 2 if changes are detected:

```npm
npx prisma migrate diff \
  --exit-code \
  --from-config-datasource \
  --to-schema=schema.prisma
```

## See also

- [Migration troubleshooting in production](/orm/prisma-migrate/workflows/patching-and-hotfixing#fixing-failed-migrations-with-migrate-diff-and-db-execute)
