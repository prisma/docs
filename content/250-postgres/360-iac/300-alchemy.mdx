---
title: 'Alchemy'
metaTitle: 'Manage Prisma Postgres with Alchemy'
metaDescription: 'Provision and manage Prisma Postgres projects, databases, and connections with Alchemy.'
tocDepth: 3
toc: true
---

Use [Alchemy](https://alchemy.run) to manage Prisma Postgres resources directly in your infrastructure code.

Alchemy provides Prisma Postgres resources for:

- Projects
- Databases
- Connections
- Workspace references

## Prerequisites

- An Alchemy project
- A Prisma service token
- `PRISMA_SERVICE_TOKEN` configured in your environment

## Authentication

Alchemy reads Prisma credentials from environment variables by default.

```terminal
export PRISMA_SERVICE_TOKEN="prsc_your_token_here"
```

If you need multiple workspaces/accounts, you can override auth per resource with `serviceToken`.

## Minimal example

```ts file=alchemy.run.ts
import alchemy from "alchemy";
import { Connection, Database, Project } from "alchemy/prisma-postgres";

const app = await alchemy("prisma-postgres-example");

const project = await Project("project");

const database = await Database("database", {
  project,
  region: "us-east-1",
});

const connection = await Connection("connection", {
  database,
  name: "app-connection",
});

export const projectId = project.id;
export const databaseId = database.id;
export const host = connection.host;
export const user = connection.user;
export const connectionString = connection.connectionString;

await app.finalize();
```

## Complete example with Hyperdrive + Worker

```ts file=alchemy.run.ts
import alchemy from "alchemy";
import { Hyperdrive, Worker } from "alchemy/cloudflare";
import { Connection, Database, Project } from "alchemy/prisma-postgres";

const app = await alchemy("prisma-postgres-example");

const project = await Project("project");

const database = await Database("database", {
  project,
  region: "us-east-1",
});

const connection = await Connection("connection", {
  database,
  name: "connection",
});

const db = await Hyperdrive("prisma-postgres", {
  origin: connection.connectionString.unencrypted,
});

export const worker = await Worker("worker", {
  entrypoint: "src/worker.ts",
  bindings: {
    HYPERDRIVE: db,
  },
  compatibilityFlags: ["nodejs_compat"],
});

await app.finalize();
```

```ts file=src/worker.ts
import { Client } from "pg";
import type { worker } from "../alchemy.run.ts";

export default {
  async fetch(_request: Request, env: typeof worker.Env): Promise<Response> {
    const client = new Client({
      connectionString: env.HYPERDRIVE.connectionString,
    });

    try {
      await client.connect();
      const result = await client.query("SELECT * FROM pg_tables");

      return Response.json({
        success: true,
        result: result.rows,
      });
    } catch (error: any) {
      return new Response(`Database error: ${error.message}`, { status: 500 });
    }
  },
};
```

## Working with multiple workspaces

Prisma service tokens are workspace-scoped. You can pass different tokens to different resources:

```ts
import alchemy from "alchemy";
import { Project } from "alchemy/prisma-postgres";

const app = await alchemy("prisma-workspaces");

const workspaceAProject = await Project("workspace-a-project", {
  serviceToken: alchemy.env.PRISMA_SERVICE_TOKEN_WORKSPACE_A,
});

const workspaceBProject = await Project("workspace-b-project", {
  serviceToken: alchemy.env.PRISMA_SERVICE_TOKEN_WORKSPACE_B,
});

await app.finalize();
```

If you need to resolve a workspace by name or id, use `WorkspaceRef`:

```ts
import { WorkspaceRef } from "alchemy/prisma-postgres";

const workspace = await WorkspaceRef("my-workspace");
```

## Deletion behavior

`Project` and `Database` default to delete protection in Alchemy.

- `Project`: `delete` defaults to `false`
- `Database`: `delete` defaults to `false`

For ephemeral environments, set `delete: true` explicitly:

```ts
const testDatabase = await Database("test-db", {
  project,
  region: "us-east-1",
  delete: true,
});
```

## References

- [Alchemy](https://alchemy.run)
- [Alchemy package on npm](https://www.npmjs.com/package/alchemy)
- [Prisma Postgres](https://www.prisma.io/postgres)
