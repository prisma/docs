---
title: 'Add custom fields and methods to query results'
metaTitle: 'Prisma Client extensions: result (Preview)'
metaDescription: 'Extend the functionality of Prisma Client'
tocDepth: 3
---

<TopBlock>

<Admonition type="warning">

This page is in draft.

</Admonition>

From version 4.7.0, you can use `result` [Prisma Client extensions](/concepts/components/prisma-client/client-extensions) to add custom fields and methods to query results.

Use the `$extends` [client-level method](/reference/api-reference/prisma-client-reference#client-methods) to create an _extended client_. An extended client is a forked variant of the standard Prisma Client with an extension applied. Use the `results` extension type to add custom fields and methods to query results.

</TopBlock>

## Enable the preview feature

Before you create Prisma Client extensions, you must enable the `clientExtensions` feature flag in the `generator` block of your `schema.prisma` file, as follows:

```prisma
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["clientExtensions"]
}
```

## Add custom fields or methods to query results

To add a custom [field](#add-a-custom-field-to-the-results-object) or [method](#add-a-custom-method-to-the-results-object) to query results, use the following structure. In this example, we extend query results in the `user` model.

```ts
const xprisma = prisma.$extends({
  name?: 'name',
  result?: {
    user: {        // in this case, we extend query results in the user model
      needs: { ... }
      fields: { ... }
    },
  },
});
```

** do we need a compute statement here? Is compute always a component? if so mention it 1. above and 2. in the parameters below**

The parameters are as follows:

- `name`: an optional field that you can use to name the extension. This name appears in error logs.
- `result`: an optional field that defines new fields and methods to the query results.
- `needs`: a required object which describes the dependencies of the result field.

** I think we remove fields **

- `fields`: a required object that contains methods which defines how the virtual field is computed when it is accessed. You must declare equivelant objects in `fields` to the objects that you declare in `needs`.

- `return`: the value of the computed field.

### Add a custom field to query results

You can use the `result` extension type to add fields to query results. These fields are computed at runtime and are type-safe.

The following example adds a new, virtual field called `fullName` to the `user` model. It declares the dependencies and the computation logic for `fullname`.

```ts
const xprisma = prisma.$extends({
  result: {
    user: {
      fullName: {
        needs: { firstName: true, lastName: true },
        compute(user) {
          return `${user.firstName} ${user.lastName}`
        },
      },
    },
  },
})

const user = await xprisma.user.findFirst()
console.log(user.fullName) // returns the user's full name, such as "John Doe"
```

In the above example, the input `user` is automatically typed according to object defined in `needs`. `firstName` and `lastName` are of type `string`, because they are specified in `needs`. If they are not specified in `needs`, then their type is `string | undefined`.

When you call a method in an extension, use the constant name from your`$extends`statement, not `prisma`. Instead, use the constant name from your`$extends`statement. In the above example,`xprisma.user.findFirst` works, but `prisma.user.findFirst` does not.

### Add a computed field to query results

The following example computes a user's title and full name in a type safe way.

```ts
const xprisma = prisma
  .$extends({
    result: {
      user: {
        fullName: {
          needs: { firstName: true, lastName: true },
          compute(user) {
            return `${user.firstName} ${user.lastName}`
          },
        },
      },
    },
  })
  .$extends({
    result: {
      user: {
        titleFullName: {
          needs: { title: true, fullName: true },
          compute(user) {
            return `${user.title} (${user.fullName})`
          },
        },
      },
    },
  })
```

#### Considerations for fields

- For performance reasons, Prisma Client computes results when your application accesses them at runtime, not on retrieval.
- You can only create fields that are based on scalar fields.
- `result` extensions don't over-fetch. Prisma Client only computes a field if its dependencies are present. In the following example, `undefined` is returned for `fullName` if the user's `email` is undefined.
  ```ts
  const user = await xprisma.user.findFirst({ select: { email: true }))
  console.log(user.fullName) // undefined
  ```

### Add a custom method to the results object

You can use the `result` extension type to add fields to query results. The following example adds a new method, `getAccountBalance` to the results object.

```ts
const xprisma = prisma.$extends({
  result: {
    user: {
      getAccountBalance: {
        needs: { account: true },
        compute((user) => (n: number) =>) {
          return user.account.balance + n
        },
      },
    },
  },
})

const result = await xprisma.user.findFirst()
console.log(result?.getAccountBalance(-500)) // 7245
```

** TBD: check above code snippet **

When you call a method in an extension, use the constant name from your`$extends`statement, not `prisma`. Instead, use the constant name from your`$extends`statement. In the above example,`xprisma.user.findFirst` works, but `prisma.user.findFirst` does not.
