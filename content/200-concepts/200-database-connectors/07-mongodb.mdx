---
title: 'MongoDB'
metaTitle: 'MongoDB database connector'
metaDescription: 'How Prisma can connect to a MongoDB database using the MongoDB database connector.'
hidePage: false
tocDepth: 2
codeStyle: false
preview: true
---

<TopBlock>

The MongoDB data source connector connects Prisma to a hosted [MongoDB](https://www.mongodb.com/) instance.

<Admonition type="info">

If you'd like to be kept up to date on the latest updates and stories about the Prisma MongoDB Connector, <a href="https://pris.ly/mongo">sign up here</a>.

</Admonition>

</TopBlock>

## Example

To connect to a MongoDB server, you need to configure a [`datasource`](../components/prisma-schema/data-sources) block in your [Prisma schema file](../components/prisma-schema):

```prisma file=schema.prisma
datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}
```

The fields passed to the `datasource` block are:

- `provider`: Specifies the `mongodb` data source connector.
- `url`: Specifies the [connection URL](#connection-url) for the MongoDB server. In this case, an [environment variable is used](../more/environment-variables) to provide the connection URL.

Because MongoDB is currently a preview feature, you need to explicitly define that in the [`generator`]() block.

```prisma file=schema.prisma
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["mongodb"]
}
```

## Connection details

### Connection URL

The MongoDB connection URL can be configured in different ways depending on how you are hosting your database. The standard configuration is made up of the following components:

![Structure of the MongoDB connection URL](./mongodb.png)

#### Base URL and path

The base URL and path sections of the connection URL are made up of your authentication credentials followed by the host (and optionally, a port number) and database.

```
mongodb://USERNAME:PASSWORD@HOST/DATABASE
```

The following components make up the _base URL_ of your database:

| Name     | Placeholder | Description                                                                                                                                                                                                                                                                                                                                                |
| :------- | :---------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| User     | `USERNAME`  | Name of your database user, e.g. `janedoe`                                                                                                                                                                                                                                                                                                                 |
| Password | `PASSWORD`  | Password for your database user                                                                                                                                                                                                                                                                                                                            |
| Host     | `HOST`      | The host where a [`mongod`](https://docs.mongodb.com/manual/reference/program/mongod/#mongodb-binary-bin.mongod) instance is running. If you are runnnig a sharded cluster this will a [`mongos`](https://docs.mongodb.com/manual/reference/program/mongos/#mongodb-binary-bin.mongos) instance. This can be a hostname, IP address or UNIX domain socket. |
| Port     | `PORT`      | Port on which your database server is running, e.g. `1234`. If none is provided the default `27017` is used.                                                                                                                                                                                                                                               |
| Database | `DATABASE`  | Name of the database to use. If none is specified but the `authSource` option is set then the `authSource` database name is used. If neither the database in the connection string nor the `authSource` option is specified then it defautls to `admin`                                                                                                    |

<Admonition type="info">

You must [percentage-encode special characters](../../../reference/database-reference/connection-urls#special-characters).

</Admonition>

#### Arguments

A connection URL can also take arguments. Here is the same example from above with placeholder values in uppercase letters for three _arguments_:

```
mongodb://USERNAME:PASSWORD@HOST/DATABASE?KEY1=VALUE&KEY2=VALUE&KEY3=VALUE
```

The following arguments can be used, **all are optional**:

| Argument name                   | Default | Description                                                                                                                                                                                                                                                                                                                    |
| :------------------------------ | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `tls`                           |         | Enables or disables TLS/SSL for the connection. New in MongoDB version 4.2. Its equivalent to the `ssl` option.                                                                                                                                                                                                                |
| `ssl`                           |         | Enables or disables TLS/SSL for the connection. Its equivalent to the `tls` option.                                                                                                                                                                                                                                            |
| `tlsCertificateKeyFile`         |         | Location of a local `.pem` file that contains a TLS/SSL certificate. New in MongoDB version 4.2.                                                                                                                                                                                                                               |
| `tlsCertificateKeyFilePassword` |         | Password for the `tlsCertificateKeyFile`. New in MongoDB version 4.2.                                                                                                                                                                                                                                                          |
| `tlsCAFile`                     |         | Location of a local `.pem` file for a root certificate chain from the Certificate Authority. New in MongoDB version 4.2.                                                                                                                                                                                                       |
| `tlsAllowInvalidCertificates`   |         | Bypasses the validation of the certificates used on the mongod/mongos instance. New in MongoDB version 4.2.                                                                                                                                                                                                                    |
| `tlsAllowInvalidHostnames`      |         | Disables the hostname validation of the certificate used by the mongod/mongos instance. New in MongoDB version 4.2.                                                                                                                                                                                                            |
| `tlsInsecure`                   |         | Disables certificate validations. New in MongoDB version 4.2.                                                                                                                                                                                                                                                                  |
| `connectTimeoutMS`              |         | Time in milliseconds the before the connection times out.                                                                                                                                                                                                                                                                      |
| `socketTimeoutMS`               |         | Time in milliseconds to send or receive on an open socket.                                                                                                                                                                                                                                                                     |
| `socket_timeout`                |         | Maximum number of seconds to wait until a single query terminates.                                                                                                                                                                                                                                                             |
| `maxPoolSize`                   | 100     | The maximum number of connections in the connection pool.                                                                                                                                                                                                                                                                      |
| `minPoolSize`                   | 0       | The minimum number of connections in the connection pool.                                                                                                                                                                                                                                                                      |
| `maxIdleTimeMS`                 |         | The maximum number of milliseconds a connection can remain idle before being closed.                                                                                                                                                                                                                                           |
| `waitQueueMultiple`             |         | The number that is multiplied by the `maxPoolSize` value to determine the amount of allowed threads that wait for the connection to become available.                                                                                                                                                                          |
| `waitQueueTimeoutMS`            |         | The maximum numnber of milliseconds a thread can wait for a connection to become available.                                                                                                                                                                                                                                    |
| `authSource`                    | `admin` | The database name that is associated with the authenticated credentials. If unspecified then the connection strings `database` field is used instead. If neither the `database` nor the `authSource` are set then the default value is `admin`                                                                                 |
| `authMechanism`                 |         | Specifies the authentication method used by MongoDB to authenticate the connection. See [authMechanism docs](https://docs.mongodb.com/manual/reference/connection-string/#mongodb-urioption-urioption.authMechanism) for a run down on the available options.                                                                  |
| `authMechanismProperties`       |         | Specifies the properties for the `authMechanism` option as a comma separated list, or a colon separated list of key-value pairs. See [authMechanismProperties docs](https://docs.mongodb.com/manual/reference/connection-string/#mongodb-urioption-urioption.authMechanismProperties) for a run down on the available options. |

An example connection URL that sets:

- An `ssl` connection
- A `connectTimeoutMS`
- And the `maxPoolSize`

Would look like the following

```
mongodb://USERNAME:PASSWORD@HOST/DATABASE?ssl=true&connectTimeoutMS=5000&maxPoolSize=50
```

<Admonition type="info">

For a more exhaustive list check the [connection string options docs](https://docs.mongodb.com/manual/reference/connection-string/#connection-string-options) on the MongoDB documentation.

</Admonition>

## Using <inlinecode>ObjectId</inlinecode>

It is common practice for the `_id` field of a MongoDB document to contain an `ObjectId`:

```json
{
  "_id": { "$oid": "60d599cb001ef98000f2cad2" },
  "createdAt": { "$date": { "$numberLong": "1624611275577" } },
  "email": "ella@prisma.io",
  "name": "Ella",
  "role": "ADMIN"
}
```

Any field (most commonly IDs and relation scalar fields) that maps to an `ObjectId` in the underlying database:

* Must be of type `String` or `Bytes`
* Must include the `@db.ObjectId` attribute
* Can optionally use `@default(dbgenerated())` to auto-generate an valid `ObjectId`

```prisma
model User {
  id  String  @id @default(dbgenerated()) @map("_id") @db.ObjectId
  // Other fields
}
```

```prisma
model User {
  id  Bytes  @id @default(dbgenerated()) @map("_id") @db.ObjectId
  // Other fields
}
```

See also: [Defining ID fields in MongoDB](../components/prisma-schema/data-model#defining-ids-in-mongodb)

### Generating `ObjectId`

To generate a valid `ObjectId` (for testing purposes or to manually set an ID field value), use the `bson` package.

```ts
import { ObjectId } from "bson"

const id = new ObjectId();
```

## Known limitations

As MongoDB support is currently in preview there are some known limitations that come with adopting Prisma into your MongoDB project, these include:

- Currently **no embedded collection support**. See [github.com/prisma/prisma/issues/6708](https://github.com/prisma/prisma/issues/6708).
  - Instead try to [normalize your data models](https://docs.mongodb.com/manual/core/data-model-design/#normalized-data-models). This involves
    describing relationships using references between documents.
- The Prisma [VSCode extension](https://marketplace.visualstudio.com/items?itemName=Prisma.prisma) doesn't currently auto format [`@db.ObjectId`](../../reference/api-reference/prisma-schema-reference#mongodb) on relations. See [github.com/prisma/prisma/issues/6717](https://github.com/prisma/prisma/issues/6717).
- The [Migrate](../components/prisma-migrate) and [Introspection](../components/introspection) workflows are currently **not** supported.
- [`@@id`](../../reference/api-reference/prisma-schema-reference#id-1) and [auto-increment](../../reference/api-reference/prisma-schema-reference#generate-auto-incrementing-integers-as-ids) are **not** currently supported.
- Error handling is incomplete.
