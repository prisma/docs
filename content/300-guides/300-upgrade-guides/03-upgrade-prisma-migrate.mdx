---
title: 'Upgrade to Prisma Migrate from legacy Prisma Migrate'
metaTitle: 'Upgrade from legacy Prisma Migrate to the most recent Prisma Migrate.'
---

<TopBlock>

The following guide describes how to upgrade from legacy Prisma Migrate (an Experimental feature available until version 2.12.0) to Prisma Migrate (2.13.0 and later).

</TopBlock>

## Prerequisites and assumptions

This guide assumes that you have already added Prisma to your project.

## Upgrade development environments

1. Make sure you Prisma schema is in sync with your database schema. To make sure, introspect your database:

   ```terminal
   npx prisma introspect
   ```

2. Initialize a new migration history:

   ```terminal
   prisma migrate dev --preview-feature
   ```

   Prisma will perform the following steps:

   1. Create a new migration directory under `prisma/migrations` with SQL migration file in it - for example: `20201126125825_first_migration/migration.sql`
   1. Detect 

3. **Initialize a new migration history** by calling `prisma migrate dev --preview-feature`. Prisma Migrate will do the following
    1. It will create a new migration directory with a SQL migration file in it
    2. It will detect that the DB is out of sync with the migration history and will prompt you to reset it. You should confirm to reset to the database (assuming it's the development environment of course!)
    3. Your database schema should now be in sync with your Prisma schema.
4. **Review the resulting schema:**
    1. Review the schema to ensure the migration leads to the desired end-state. Maybe compare it to the schema of your production database if you have any?
    2. Commit the migrations directory to your repository

    ## Populating the changes to other development environments

In other development environments, i.e. other collaborators on the project:

1. Check out a copy of the repository with the new migration directory
2. Call `prisma migrate dev --preview-feature` to reset the development database

**What to do next: Baseline any database with existing data, such as production or staging**

### Baselining your production environment

Assuming you have successfully transitioned to the new version of Prisma Migration and initialized a new migration history in your repository, as laid above, you now need to baseline any database that may contain data that you care about, i.e. staging, production.

In development, we assume it is acceptable to reset your database to make sure your migration files are in sync with your database schema, but this happens at the expense of losing data. For production and any other environments, where you may have data you care about, this is of course not acceptable.

This is why we support something we call baselining. Baselining works by creating the migrations table in the database if it does not exist yet and creating new entries in this migrations table to record one or multiple migrations as applied without actually executing them.

Any migrations that come after baselined migrations will actually be executed, so by baselining a database you are making sure you can use migrations to make future changes to the database schema, skipping the migrations that lead to this current database state, which are not needed and would presume an empty database.   

In your production environment or against the production environment, do the following steps:

1. Make sure you have a working copy of the new migrations directory
2. Call `prisma migrate resolve --applied "20201124-create-users"` to baseline a migration. Repeat this multiple times if you are baselining multiple migrations.
