---
title: 'Deploying migrations from a local environment'
metaTitle: 'Deploying migrations from a local environment'
metaDescription: 'Learn how to deploy Node.js and TypeScript applications that are using Prisma Client locally.'
tocDepth: 3
---

<TopBlock>

There are instances whereby you might want to run a deployment migration locally. This page outlines some examples of how you can do that and **why its generally a bad practice**.

</TopBlock>

## Local CI/CD pipeline

You want to control the CI/CD process locally. You have a database with 3 environments, development, staging and production. You keep 3 different connection strings which each relate to a different environment as `.env` variables.

Having made some changes to your schema you want to run a migration against your development environment so that those changes are reflected in your database. You run `prisma migrate dev` and the migration is applied.

Next you want to manually sync your staging and production environments too.

### A potential solution

> **_We stongly discourage this solution due to the following reasons, use it at your own discretion!_ **
>
> - You risk exposing your production database connection string to version control.
> - You may accidentally use your production connection string instead and in turn **override or delete your production database**.

You can comment out your development and staging connection strings and run `prisma migrate deploy`, this will update your production database with your new schema changes.

> **Note**: `prisma migrate deploy` should generally be part of an automated CI/CD pipeline, and we do not recommend running this command locally to deploy changes to a production database. It is not generally considered good practice to store the production database URL locally.

### An alternative approach

An alternative approach would be to let an automated CI/CD pipeline handle your staging and production environments.

If your goal is to prototype your schema and still have 3 environments that mock a real world use case then you might consider using the [`db push`](../../../../concepts/components/prisma-migrate/db-push) command.

## Add migrations to a pre-existing database locally.

Sometimes you have a database that has not had any migrations run on it. Its either a brownfield project or a project you have yet to introduce Prisma to. You have now decided that you would like to harness the power of Prisma Migrations.

You can begin by running `prisma migrate dev` on your development environment database (that is, using your development database connection string). This will create a new migration history, if you were to run `prisma migrate deploy` on your production environment, it would fail however. This is because `prisma migrate deploy` will try to re-create an existing state.

The solution is to [baseline](../../application-lifecycle/add-prisma-migrate-to-a-project#baseline-your-production-environment) your production database.

Baselining your database is used when you want to add Prisma Migrate to an existing database that doesn't have any migrations applied to it, in our example that would be the production database.

When a migration is run it is added to a `_prisma_migrations` table under the hood, that migration is registered as "applied". The production database can be added to the `_prisma_migrations` table by running `prisma migrate resolve --applied "MIGRATION_NAME"`, this will add the database to the migrations, ignore any previously "applied" migrations and in effect reset the migrations with the added production database.

Next time you run `prisma migrate deploy`, any new migrations that are run after a baseline will be applied.
